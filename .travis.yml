sudo: false

language: c

cache: apt

compiler:
    - gcc
    - clang

env:
    - BUILDTOOL="cmake" BUILDARGS=""
    - BUILDTOOL="cmake" BUILDARGS="-DENABLE_PYTHON3=ON"
    - BUILDTOOL="cmake" BUILDARGS="-DENABLE_GNUTLS=OFF"
    - BUILDTOOL="autotools" BUILDARGS=""
    - BUILDTOOL="autotools" BUILDARGS="--enable-python3"
    - BUILDTOOL="autotools" BUILDARGS="--disable-gnutls"

before_script:
    - pip install msgcheck pylint --user

script:
    - ./tools/build-test.sh
    - msgcheck po/*.po
    - pylint --version
    - pylint doc/docgen.py

after_success:
    - weechat --help
    - weechat-curses --help
    - weechat -r "/debug libs;/quit"

matrix:
    fast_finish: true

addons:
    apt:
        packages:
            - devscripts
            - equivs
            - python-pip
            - python-wheel
            - libenchant-dev
            - autopoint asciidoc
            - source-highlight
            - xsltproc
            - docbook-xsl
            - docbook-xml
            - cmake pkg-config
            - libncursesw5-dev
            - gem2deb
            - libperl-dev
            - python-dev
            - python3-dev
            - libaspell-dev
            - liblua5.1-0-dev
            - tcl8.5-dev
            - guile-2.0-dev
            - libv8-dev
            - libcurl4-gnutls-dev
            - libgcrypt11-dev
            - libgnutls-dev
            - zlib1g-dev
            - curl
            - libcpputest-dev
